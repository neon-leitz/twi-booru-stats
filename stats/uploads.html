<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="favicon.ico" sizes="any">
    <link rel="icon" href="favicon.svg" type="image/svg+xml">

    <title>TWI Booru Stats</title>

    <!-- Plotly -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script>

    <!-- CSS links -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/styles.css">
  </head>

  <body>
    <div class="favicon">
      <a href="/twi-booru-stats/stats/">
        <img src="favicon.svg"></img>
      </a>
    </div>
    <nav>
      <a href="/twi-booru-stats/stats/">Home</a>
      <a href="/twi-booru-stats/stats/uploads.html">Uploads</a>
      <a href="/twi-booru-stats/stats/characters.html">Characters</a>
      <a href="/twi-booru-stats/stats/artists.html">Artists</a>
      <a href="/twi-booru-stats/stats/books.html">Books</a>
      <a href="/twi-booru-stats/stats/volumes.html">Volumes</a>
    </nav>
    <main id="chart">
    </main>
  </body>
</html>

<script type="text/javascript" src="js/default_config.js"></script>
<script type="text/javascript" src="js/utils.js"></script>
<script type="module">
  let posts_by_day = await fetch_json_data("data/posts_per_day.json")
  let posts_by_day_cumulative = await fetch_json_data("data/posts_per_day_cumulative.json")
  let base_counts = {
    x: Object.keys(posts_by_day).slice(1),
    y: Object.values(posts_by_day).slice(1),
    marker: {
      color: "#56D481",
    },
    name: "Upload count",
    type: "scatter",
  }

  let cumulative_counts = {
    x: Object.keys(posts_by_day_cumulative),
    y: Object.values(posts_by_day_cumulative),
    marker: {
      color: "#4C7EE1",
    },
    fill: "tozeroy",
    name: "Total upload count",
    type: "scatter",
    showlegend: true,
  }

  let data = [base_counts, cumulative_counts];

  let layout = default_layout;
  layout["showlegend"] = true;

  Plotly.newPlot("chart", data, layout, {
    displaylogo: false,
    responsive: true,
  });
</script>
